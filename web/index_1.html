<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>Usuários</title>
        <meta charset="UTF-8">
        <script>
            function cadastrarUsuario() {
                var elCadEmail = document.getElementById("cadEmail");
                var elCadSenha = document.getElementById("cadSenha");
                var elCadNome = document.getElementById("cadNome");
                
                var usuario = {
                    email: elCadEmail.value,
                    senha: elCadSenha.value,
                    nome: elCadNome.value
                };
                
                var req = new XMLHttpRequest();
                req.onreadystatechange = function() {
                    if (this.readyState == XMLHttpRequest.DONE) {
                            //&& this.status == 201) {
                        //alert("Usuário criado!");
                        alert("Status: " + this.status);
                    }
                }
                req.open("POST", "usuarios/" + usuario.email, true);
                req.setRequestHeader(
                        "Content-Type", 
                        "application/json");
                req.send(JSON.stringify(usuario));
            }
            
            function buscarUsuario() {
                var elBuscaEmail = document.getElementById("buscaEmail");
                var elDivNome = document.getElementById("divNome");
                var email = elBuscaEmail.value;
                
                var req = new XMLHttpRequest();
                req.onreadystatechange = function() {
                    if (this.readyState == XMLHttpRequest.DONE) {
                            //&& this.status == 201) {
                        var usuario = JSON.parse(this.responseText);
                        elDivNome.innerText = usuario.nome;
                    }
                }
                req.open("GET", "usuarios/" + email, true);
                req.send();
            }
        </script>
    </head>
    <body>
        <div>
            <h2>Cadastrar</h2>
            <div>E-mail: <input type="text" id="cadEmail" /></div>
            <div>Senha: <input type="password" id="cadSenha" /></div>
            <div>Nome: <input type="text" id="cadNome" /></div>
            <div><input type="submit" value="Enviar" 
                        onclick="cadastrarUsuario()" /></div>
        </div>
        
        <div>
            <h2>Buscar</h2>
            <div>E-mail: <input type="text" id="buscaEmail" />
                <input type="submit" value="Enviar" 
                       onclick="buscarUsuario()" /></div>
        </div>
        
        <div id="divNome">
        </div>
    </body>
</html>
